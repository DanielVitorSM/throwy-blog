import{m as Fe,A as j,U as Oe,d as Ce,aS as ke,r as D,aT as Pe,k as ve,o as je,g as De,b as M,at as Se,aU as Le,aV as Me,a as y,w as E,a2 as ze,F as Ie,j as S,$ as He,a0 as V,a3 as We,u as Ne}from"./app-b69ccc3c.js";import{Q as _e}from"./QSpace-654b85e0.js";import{u as qe,a as Ve}from"./use-ratio-73183db8.js";import{a as me}from"./notify-0d4c84f3.js";import{v as $e}from"./functions-1e89eafd.js";import{f as Ge}from"./index.esm-bundler-d1d05260.js";import"./use-dialog-plugin-component-4f3461ce.js";const Qe=Fe({name:"QResponsive",props:qe,setup(r,{slots:e}){const t=Ve(r);return()=>j("div",{class:"q-responsive"},[j("div",{class:"q-responsive__filler overflow-hidden"},[j("div",{style:t.value})]),j("div",{class:"q-responsive__content absolute-full fit"},Oe(e.default))])}});/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function de(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,a)}return t}function L(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?de(Object(t),!0).forEach(function(a){Ke(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):de(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}function Xe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function pe(r,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,xe(a.key),a)}}function Ye(r,e,t){return e&&pe(r.prototype,e),t&&pe(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ke(r,e,t){return e=xe(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function z(){return z=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},z.apply(this,arguments)}function Je(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var a=t.call(r,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function xe(r){var e=Je(r,"string");return typeof e=="symbol"?e:String(e)}var Be={exports:{}};(function(r){typeof window>"u"||function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,a=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),i=a&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,m=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,u=(a||n)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(l){var s,h,v,b,c,o,f,d,B;if(s=l.match(m),!s)throw new Error("invalid data URI");for(h=s[2]?s[1]:"text/plain"+(s[3]||";charset=US-ASCII"),v=!!s[4],b=l.slice(s[0].length),v?c=atob(b):c=decodeURIComponent(b),o=new ArrayBuffer(c.length),f=new Uint8Array(o),d=0;d<c.length;d+=1)f[d]=c.charCodeAt(d);return a?new Blob([i?f:o],{type:h}):(B=new n,B.append(o),B.getBlob(h))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(l,s,h){var v=this;setTimeout(function(){h&&t.toDataURL&&u?l(u(v.toDataURL(s,h))):l(v.mozGetAsFile("blob",s))})}:t.toDataURL&&u&&(t.msToBlob?t.toBlob=function(l,s,h){var v=this;setTimeout(function(){(s&&s!=="image/png"||h)&&t.toDataURL&&u?l(u(v.toDataURL(s,h))):l(v.msToBlob(s))})}:t.toBlob=function(l,s,h){var v=this;setTimeout(function(){l(u(v.toDataURL(s,h)))})})),r.exports?r.exports=u:e.dataURLtoBlob=u}(window)})(Be);var ge=Be.exports,Ze=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},be={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},et=typeof window<"u"&&typeof window.document<"u",w=et?window:{},I=function(e){return e>0&&e<1/0},tt=Array.prototype.slice;function Q(r){return Array.from?Array.from(r):tt.call(r)}var at=/^image\/.+$/;function G(r){return at.test(r)}function rt(r){var e=G(r)?r.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Re=String.fromCharCode;function it(r,e,t){var a="",i;for(t+=e,i=e;i<t;i+=1)a+=Re(r.getUint8(i));return a}var nt=w.btoa;function ye(r,e){for(var t=[],a=8192,i=new Uint8Array(r);i.length>0;)t.push(Re.apply(null,Q(i.subarray(0,a)))),i=i.subarray(a);return"data:".concat(e,";base64,").concat(nt(t.join("")))}function ot(r){var e=new DataView(r),t;try{var a,i,n;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var m=e.byteLength,u=2;u+1<m;){if(e.getUint8(u)===255&&e.getUint8(u+1)===225){i=u;break}u+=1}if(i){var l=i+4,s=i+10;if(it(e,l,4)==="Exif"){var h=e.getUint16(s);if(a=h===18761,(a||h===19789)&&e.getUint16(s+2,a)===42){var v=e.getUint32(s+4,a);v>=8&&(n=s+v)}}}if(n){var b=e.getUint16(n,a),c,o;for(o=0;o<b;o+=1)if(c=n+o*12+2,e.getUint16(c,a)===274){c+=8,t=e.getUint16(c,a),e.setUint16(c,1,a);break}}}catch{t=1}return t}function lt(r){var e=0,t=1,a=1;switch(r){case 2:t=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:a}}var st=/\.\d*(?:0|9){12}\d*$/;function we(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return st.test(r)?Math.round(r*e)/e:r}function P(r){var e=r.aspectRatio,t=r.height,a=r.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",n=I(a),m=I(t);if(n&&m){var u=t*e;(i==="contain"||i==="none")&&u>a||i==="cover"&&u<a?t=a/e:a=t*e}else n?t=a/e:m&&(a=t*e);return{width:a,height:t}}function ut(r){for(var e=Q(new Uint8Array(r)),t=e.length,a=[],i=0;i+3<t;){var n=e[i],m=e[i+1];if(n===255&&m===218)break;if(n===255&&m===216)i+=2;else{var u=e[i+2]*256+e[i+3],l=i+u+2,s=e.slice(i,l);a.push(s),i=l}}return a.reduce(function(h,v){return v[0]===255&&v[1]===225?h.concat(v):h},[])}function ct(r,e){var t=Q(new Uint8Array(r));if(t[2]!==255||t[3]!==224)return r;var a=t[4]*256+t[5],i=[255,216].concat(e,t.slice(4+a));return new Uint8Array(i)}var ft=w.ArrayBuffer,$=w.FileReader,x=w.URL||w.webkitURL,ht=/\.\w+$/,vt=w.Compressor,mt=function(){function r(e,t){Xe(this,r),this.file=e,this.exif=[],this.image=new Image,this.options=L(L({},be),t),this.aborted=!1,this.result=null,this.init()}return Ye(r,[{key:"init",value:function(){var t=this,a=this.file,i=this.options;if(!Ze(a)){this.fail(new Error("The first argument must be a File or Blob object."));return}var n=a.type;if(!G(n)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!x||!$){this.fail(new Error("The current browser does not support image compression."));return}ft||(i.checkOrientation=!1,i.retainExif=!1);var m=n==="image/jpeg",u=m&&i.checkOrientation,l=m&&i.retainExif;if(x&&!u&&!l)this.load({url:x.createObjectURL(a)});else{var s=new $;this.reader=s,s.onload=function(h){var v=h.target,b=v.result,c={},o=1;u&&(o=ot(b),o>1&&z(c,lt(o))),l&&(t.exif=ut(b)),u||l?!x||o>1?c.url=ye(b,n):c.url=x.createObjectURL(a):c.url=b,t.load(c)},s.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},s.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},s.onloadend=function(){t.reader=null},u||l?s.readAsArrayBuffer(a):s.readAsDataURL(a)}}},{key:"load",value:function(t){var a=this,i=this.file,n=this.image;n.onload=function(){a.draw(L(L({},t),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){a.fail(new Error("Aborted to load the image."))},n.onerror=function(){a.fail(new Error("Failed to load the image."))},w.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(w.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=t.url}},{key:"draw",value:function(t){var a=this,i=t.naturalWidth,n=t.naturalHeight,m=t.rotate,u=m===void 0?0:m,l=t.scaleX,s=l===void 0?1:l,h=t.scaleY,v=h===void 0?1:h,b=this.file,c=this.image,o=this.options,f=document.createElement("canvas"),d=f.getContext("2d"),B=Math.abs(u)%180===90,H=(o.resize==="contain"||o.resize==="cover")&&I(o.width)&&I(o.height),A=Math.max(o.maxWidth,0)||1/0,T=Math.max(o.maxHeight,0)||1/0,F=Math.max(o.minWidth,0)||0,O=Math.max(o.minHeight,0)||0,R=i/n,p=o.width,g=o.height;if(B){var X=[T,A];A=X[0],T=X[1];var Y=[O,F];F=Y[0],O=Y[1];var K=[g,p];p=K[0],g=K[1]}H&&(R=p/g);var J=P({aspectRatio:R,width:A,height:T},"contain");A=J.width,T=J.height;var Z=P({aspectRatio:R,width:F,height:O},"cover");if(F=Z.width,O=Z.height,H){var ee=P({aspectRatio:R,width:p,height:g},o.resize);p=ee.width,g=ee.height}else{var te=P({aspectRatio:R,width:p,height:g}),ae=te.width;p=ae===void 0?i:ae;var re=te.height;g=re===void 0?n:re}p=Math.floor(we(Math.min(Math.max(p,F),A))),g=Math.floor(we(Math.min(Math.max(g,O),T)));var Ue=-p/2,Ee=-g/2,Ae=p,Te=g,W=[];if(H){var ie=0,ne=0,N=i,_=n,oe=P({aspectRatio:R,width:i,height:n},{contain:"cover",cover:"contain"}[o.resize]);N=oe.width,_=oe.height,ie=(i-N)/2,ne=(n-_)/2,W.push(ie,ne,N,_)}if(W.push(Ue,Ee,Ae,Te),B){var le=[g,p];p=le[0],g=le[1]}f.width=p,f.height=g,G(o.mimeType)||(o.mimeType=b.type);var se="transparent";b.size>o.convertSize&&o.convertTypes.indexOf(o.mimeType)>=0&&(o.mimeType="image/jpeg");var ue=o.mimeType==="image/jpeg";if(ue&&(se="#fff"),d.fillStyle=se,d.fillRect(0,0,p,g),o.beforeDraw&&o.beforeDraw.call(this,d,f),!this.aborted&&(d.save(),d.translate(p/2,g/2),d.rotate(u*Math.PI/180),d.scale(s,v),d.drawImage.apply(d,[c].concat(W)),d.restore(),o.drew&&o.drew.call(this,d,f),!this.aborted)){var ce=function(C){if(!a.aborted){var fe=function(k){return a.done({naturalWidth:i,naturalHeight:n,result:k})};if(C&&ue&&o.retainExif&&a.exif&&a.exif.length>0){var he=function(k){return fe(ge(ye(ct(k,a.exif),o.mimeType)))};if(C.arrayBuffer)C.arrayBuffer().then(he).catch(function(){a.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var U=new $;a.reader=U,U.onload=function(q){var k=q.target;he(k.result)},U.onabort=function(){a.fail(new Error("Aborted to read the compressed image with FileReader."))},U.onerror=function(){a.fail(new Error("Failed to read the compressed image with FileReader."))},U.onloadend=function(){a.reader=null},U.readAsArrayBuffer(C)}}else fe(C)}};f.toBlob?f.toBlob(ce,o.mimeType,o.quality):ce(ge(f.toDataURL(o.mimeType,o.quality)))}}},{key:"done",value:function(t){var a=t.naturalWidth,i=t.naturalHeight,n=t.result,m=this.file,u=this.image,l=this.options;if(x&&u.src.indexOf("blob:")===0&&x.revokeObjectURL(u.src),n)if(l.strict&&!l.retainExif&&n.size>m.size&&l.mimeType===m.type&&!(l.width>a||l.height>i||l.minWidth>a||l.minHeight>i||l.maxWidth<a||l.maxHeight<i))n=m;else{var s=new Date;n.lastModified=s.getTime(),n.lastModifiedDate=s,n.name=m.name,n.name&&n.type!==m.type&&(n.name=n.name.replace(ht,rt(n.type)))}else n=m;this.result=n,l.success&&l.success.call(this,n)}},{key:"fail",value:function(t){var a=this.options;if(a.error)a.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=vt,r}},{key:"setDefaults",value:function(t){z(be,t)}}]),r}();const dt=["accept"],pt=M("span",{class:"text-h6"},"Recortar imagem",-1),gt={class:"col-6"},bt={class:"col-6"},Tt=Ce({__name:"Cropper",props:ke({accept:{type:String,default:()=>"jpg,jpeg,png"},maxSize:{type:Number,default:()=>4096},aspectRatio:{type:Number,default:()=>16/9},convertTo:{type:String,default:()=>"jpg"},quality:{type:Number,default:()=>.8}},{modelValue:{type:File}}),emits:["update:modelValue"],setup(r){const e=D(null),t=D(null),a=Pe(r,"modelValue"),i=D(null),n=D(!1),m=ve(()=>a.value?a.value instanceof File?URL.createObjectURL(a.value):a.value:null),u=ve(()=>t.value?URL.createObjectURL(t.value):null),l=c=>new Promise((o,f)=>{new mt(c,{quality:r.quality,async success(d){t.value&&o(new File([d],t.value.name,{lastModified:t.value.lastModified,type:d.type}))},error(d){f(d)}})}),s=()=>{const{canvas:c}=e.value.getResult();c&&(n.value=!0,c.toBlob(async o=>{if(!o)return n.value=!1;l(o).then(f=>{a.value=f,t.value=null}).catch(f=>{console.log(f),me("Não foi possível recortar a imagem")}).finally(()=>n.value=!1)},r.convertTo))},h=()=>{i.value&&i.value.click()},v=()=>{t.value=null},b=c=>{const o=c.target,f=o.files?o.files.item(0):null;try{if(!f)return;f.size>r.maxSize&&$e(f,r.accept.split(",")),t.value=f,o.value=""}catch(d){me(d.message)}};return(c,o)=>(je(),De(Ie,null,[M("input",{ref_key:"input",ref:i,hidden:"",type:"file",onInput:b,accept:r.accept.split(",").map(f=>`.${f}`).join(",")},null,40,dt),Se(c.$slots,"button",Le(Me({previewSrc:m.value,getFile:h})),()=>[y(S,{label:"Enviar",onClick:h})]),y(ze,{"model-value":!!u.value,onHide:v},{default:E(()=>[y(He,{class:"q-dialog-plugin",style:{width:"700px","max-width":"80vw"}},{default:E(()=>[y(V,{class:"row no-wrap items-center"},{default:E(()=>[y(We,{icon:"crop",color:"grey-4","text-color":"black",size:"md",class:"q-mr-sm"}),pt,y(_e),y(S,{round:"",flat:"",dense:"",size:"sm",color:"grey-8",icon:"close",onClick:v})]),_:1}),y(V,{class:"q-pt-none"},{default:E(()=>[y(Qe,{ratio:c.$q.screen.xs?1:16/9},{default:E(()=>[y(Ne(Ge),{src:u.value,ref_key:"cropperRef",ref:e,class:"full-height full-width","stencil-props":{aspectRatio:r.aspectRatio},"default-boundaries":"fill",priority:"visibleArea"},null,8,["src","stencil-props"])]),_:1},8,["ratio"])]),_:1}),y(V,{class:"row q-col-gutter-md"},{default:E(()=>[M("div",gt,[y(S,{flat:"",color:"primary",label:"Cancelar",class:"full-width",onClick:v,disable:n.value},null,8,["disable"])]),M("div",bt,[y(S,{color:"primary",label:"Salvar",class:"full-width",onClick:s,loading:n.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1},8,["model-value"])],64))}});export{Tt as _};
