import{m as J,q as W,r as B,k as G,I as X,J as Z,K as Y,A as Q,j as V,d as ee,T as te,o as f,g as h,a,u as t,w as c,b as r,t as p,e as H,Q as I,i as b,c as U,C as M,f as q,h as oe,L as le,F as se,Z as ne,O as ae,l as re}from"./app-5030ba9c.js";import{a as ie}from"./QResizeObserver-f0dde46e.js";import{Q as ue}from"./QSpace-ddeb61a4.js";import{Q as L}from"./QImg-ffef611b.js";import{Q as de}from"./QForm-b40cd24c.js";import{_ as ce}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-af643a16.js";import{u as me}from"./use-quasar-dc29eaa5.js";import{Q as fe}from"./use-fullscreen-64d58db0.js";import{_ as $,Q as pe}from"./ExpansionCard.vue_vue_type_script_setup_true_lang-fa4b23a1.js";import{_ as ge}from"./Cropper.vue_vue_type_script_setup_true_lang-366d4fce.js";import{f as j}from"./functions-143f5d97.js";import{_ as K}from"./EditCategory.vue_vue_type_script_setup_true_lang-1357bb20.js";import"./position-engine-fff9eec8.js";import"./use-ratio-d7ae1c91.js";import"./QItem-07e05882.js";import"./AppLogo-f446dfdb.js";import"./QExpansionItem-ff3665f2.js";import"./touch-5ff41afe.js";import"./format-7985d814.js";import"./notify-7cd72d17.js";import"./QChip-b322b801.js";import"./QTooltip-c398c1dc.js";import"./use-dialog-plugin-component-4d81b402.js";import"./constants-dc375e8c.js";function D(e,d=new WeakMap){if(Object(e)!==e)return e;if(d.has(e))return d.get(e);const i=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const u=e.valueOf();if(Object(u)!==u){const o=new e.constructor(u);return d.set(e,o),o}}return d.set(e,i),e instanceof Set?e.forEach(u=>{i.add(D(u,d))}):e instanceof Map&&e.forEach((u,o)=>{i.set(o,D(u,d))}),Object.assign(i,...Object.keys(e).map(u=>({[u]:D(e[u],d)})))}const be=J({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:d,emit:i}){const{proxy:u}=W(),{$q:o}=u,v=B(null),y=B(""),m=B("");let C=!1;const F=G(()=>X({initialValue:y.value,validate:e.validate,set:w,cancel:x,updatePosition:S},"value",()=>m.value,n=>{m.value=n}));function w(){e.validate(m.value)!==!1&&(k()===!0&&(i("save",m.value,y.value),i("update:modelValue",m.value)),P())}function x(){k()===!0&&i("cancel",m.value,y.value),P()}function S(){Z(()=>{v.value.updatePosition()})}function k(){return Y(m.value,y.value)===!1}function P(){C=!0,v.value.hide()}function E(){C=!1,y.value=D(e.modelValue),m.value=D(e.modelValue),i("beforeShow")}function O(){i("show")}function T(){C===!1&&k()===!0&&(e.autoSave===!0&&e.validate(m.value)===!0?(i("save",m.value,y.value),i("update:modelValue",m.value)):i("cancel",m.value,y.value)),i("beforeHide")}function z(){i("hide")}function A(){const n=d.default!==void 0?[].concat(d.default(F.value)):[];return e.title&&n.unshift(Q("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&n.push(Q("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[Q(V,{flat:!0,color:e.color,label:e.labelCancel||o.lang.label.cancel,onClick:x}),Q(V,{flat:!0,color:e.color,label:e.labelSet||o.lang.label.set,onClick:w})])),n}return Object.assign(u,{set:w,cancel:x,show(n){v.value!==null&&v.value.show(n)},hide(n){v.value!==null&&v.value.hide(n)},updatePosition:S}),()=>{if(e.disable!==!0)return Q(ie,{ref:v,class:"q-popup-edit",cover:e.cover,onBeforeShow:E,onShow:O,onBeforeHide:T,onHide:z,onEscapeKey:x},A)}}}),ve={class:"q-mb-lg row items-center"},ye={class:"text-bold text-h4 q-ma-none"},he={class:"col-12 col-md-8"},Ve={class:"row q-col-gutter-md"},we={class:"col-12"},xe={key:0,class:"col-12"},ke={class:"col-12"},qe={class:"col-12 fixed-toolbar"},Ce={key:0,class:"text-negative"},Se={class:"col-12 col-md-4"},Pe={class:"row"},Qe={class:"col-12 q-gutter-md"},Be={key:0,class:"row q-gutter-xs items-center"},De=r("span",null,"Autor:",-1),Ee={class:"text-bold"},Oe={class:"row q-gutter-xs items-center"},Te=r("span",null,"Visibilidade:",-1),ze={class:"text-bold"},Ae={key:1,class:"row q-gutter-xs items-center"},_e=r("span",null,"Publicado em:",-1),Ue={class:"text-bold"},$e={key:2,class:"row q-gutter-xs items-center"},je=r("span",null,"Criado em:",-1),Fe={class:"text-bold"},Ie={key:3,class:"row q-gutter-xs items-center"},Me=r("span",null,"Atualizado em:",-1),Re={class:"text-bold"},Ne={key:4,class:"row q-gutter-xs items-center"},He=r("span",null,"Arquivado em:",-1),Le={class:"text-bold"},Ke={class:"row items-center"},Ge=["onClick"],ht=ee({__name:"Post",props:{post:{type:Object},categories:{type:Array,required:!0},tags:{type:Array}},setup(e){var k,P,E,O,T,z,A;const d=me(),i=B([]),u=B(),o=te({_method:e.post?"PUT":"POST",title:((k=e.post)==null?void 0:k.title)??"",slug:((P=e.post)==null?void 0:P.slug)??"",caption:((E=e.post)==null?void 0:E.caption)??"",content:((O=e.post)==null?void 0:O.content)??"",category_id:((T=e.post)==null?void 0:T.category.id)??null,tags:((z=e.post)==null?void 0:z.tags.map(n=>n.name))??[],banner:void 0,published:((A=e.post)==null?void 0:A.published)??!1}),v=[["bold","italic","strike","underline","subscript","superscript"],[{icon:d.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]},"quote","unordered","ordered","outdent","indent"],["hr","link",{icon:d.iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{icon:d.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},"removeFormat"],["undo","redo","fullscreen","viewsource"]],y=()=>d.dialog({component:K}),m=n=>d.dialog({component:K,componentProps:{categoryId:n}}),C=()=>{i.value=[]},F=(n,s,l)=>{if(n.length<=2)return l();axios.get(route("tags.index"),{params:{search:n}}).then(g=>{const{body:_}=g.data;s(()=>{i.value=_})}).catch(()=>l())},w=()=>{const n=e.post?route("posts.update",{id:e.post.id}):route("posts.store"),s=e.post?{"X-Reload":"true"}:void 0;o.post(n,{headers:s})},x=n=>{if(n.target.nodeName==="INPUT"||!u.value)return;let s,l;n.preventDefault(),n.stopPropagation(),n.originalEvent&&n.originalEvent.clipboardData.getData?(s=n.originalEvent.clipboardData.getData("text/plain"),u.value.runCmd("insertText",s)):n.clipboardData&&n.clipboardData.getData?(s=n.clipboardData.getData("text/plain"),u.value.runCmd("insertText",s)):window.clipboardData&&window.clipboardData.getData&&(l||(l=!0,u.value.runCmd("ms-pasteTextOnly",s)),l=!1)},S=G(()=>e.post?"Editar post":"Novo post");return(n,s)=>(f(),h(se,null,[a(t(ne),{title:S.value},null,8,["title"]),a(ce,null,{default:c(()=>[r("section",ve,[r("h2",ye,p(S.value),1)]),r("section",null,[a(de,{onSubmit:H(w,["prevent"]),class:"row q-col-gutter-md"},{default:c(()=>[r("div",he,[r("section",Ve,[r("div",we,[a(I,{"hide-bottom-space":"",outlined:"",dense:"",onBlur:s[0]||(s[0]=l=>t(o).clearErrors()),modelValue:t(o).title,"onUpdate:modelValue":s[1]||(s[1]=l=>t(o).title=l),label:"Título",error:!!t(o).errors.title,"error-message":t(o).errors.title},null,8,["modelValue","error","error-message"])]),e.post?(f(),h("div",xe,[a(I,{"hide-bottom-space":"",outlined:"",dense:"",onBlur:s[2]||(s[2]=l=>t(o).clearErrors()),modelValue:t(o).slug,"onUpdate:modelValue":s[3]||(s[3]=l=>t(o).slug=l),label:"Slug",error:!!t(o).errors.slug,"error-message":t(o).errors.slug},null,8,["modelValue","error","error-message"])])):b("",!0),r("div",ke,[a(I,{"hide-bottom-space":"",dense:"",onBlur:s[4]||(s[4]=l=>t(o).clearErrors()),outlined:"",modelValue:t(o).caption,"onUpdate:modelValue":s[5]||(s[5]=l=>t(o).caption=l),label:"Legenda",type:"textarea",rows:3,error:!!t(o).errors.caption,"error-message":t(o).errors.caption},null,8,["modelValue","error","error-message"])]),r("div",qe,[a(t(pe),{ref_key:"editorRef",ref:u,"hide-bottom-space":"",modelValue:t(o).content,"onUpdate:modelValue":s[6]||(s[6]=l=>t(o).content=l),dense:t(d).screen.lt.md,onBlur:s[7]||(s[7]=l=>t(o).clearErrors()),onPaste:x,toolbar:v,"toolbar-bg":t(o).errors.content?"negative":"","toolbar-text-color":t(o).errors.content?"white":""},null,8,["modelValue","dense","toolbar-bg","toolbar-text-color"]),t(o).errors.content?(f(),h("small",Ce,p(t(o).errors.content),1)):b("",!0)])])]),r("div",Se,[r("section",Pe,[r("div",Qe,[a($,{"model-value":"",label:"Publicar"},{footer:c(()=>{var l;return[e.post?(f(),U(V,{key:0,disable:t(o).processing,dense:"",flat:"","no-caps":"",unelevated:"",label:e.post.deleted_at?"Remover permanentemente":"Remover",color:"negative",onClick:s[9]||(s[9]=()=>{var g;return t(ae).delete(n.$route("posts.destroy",{id:(g=e.post)==null?void 0:g.id}))})},null,8,["disable","label"])):b("",!0),a(ue),e.post?(f(),U(t(re),{key:1,href:n.$route("blog.show",{slug:(l=e.post)==null?void 0:l.slug}),class:"q-mr-sm text-reset"},{default:c(()=>[a(V,{disable:t(o).processing,dense:"",round:"",unelevated:"",icon:"visibility",size:"md"},null,8,["disable"])]),_:1},8,["href"])):b("",!0),a(V,{percentage:t(o).progress?t(o).progress.percentage:100,disable:t(o).processing,dense:"","no-caps":"",onClick:w,unelevated:"",color:"primary"},{default:c(()=>[M(p(e.post?"Atualizar":"Publicar"),1)]),_:1},8,["percentage","disable"])]}),default:c(()=>[e.post&&e.post.author?(f(),h("div",Be,[a(q,{name:"person",color:"grey-8"}),De,r("span",Ee,p(e.post.author.name),1)])):b("",!0),r("div",Oe,[a(q,{name:"visibility",color:"grey-8"}),Te,r("div",null,[r("span",ze,p(t(o).published?"Público":"Privado"),1),a(V,{dense:"",icon:"edit",size:"sm",round:"",flat:""},{default:c(()=>[a(be,{modelValue:t(o).published,"onUpdate:modelValue":s[8]||(s[8]=l=>t(o).published=l),"auto-save":""},{default:c(l=>[a(oe,{modelValue:l.value,"onUpdate:modelValue":g=>l.value=g,label:"Público"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})])]),e.post&&e.post.published_at?(f(),h("div",Ae,[a(q,{name:"event",color:"grey-8"}),_e,r("span",Ue,p(t(j)(e.post.published_at)),1)])):b("",!0),e.post&&e.post.created_at?(f(),h("div",$e,[a(q,{name:"event",color:"grey-8"}),je,r("span",Fe,p(t(j)(e.post.created_at)),1)])):b("",!0),e.post&&e.post.updated_at?(f(),h("div",Ie,[a(q,{name:"event",color:"grey-8"}),Me,r("span",Re,p(t(j)(e.post.updated_at)),1)])):b("",!0),e.post&&e.post.deleted_at?(f(),h("div",Ne,[a(q,{name:"event",color:"grey-8"}),He,r("span",Le,p(t(j)(e.post.deleted_at)),1)])):b("",!0)]),_:1}),a($,{"error-message":t(o).errors.banner,label:"Capa"},{footer:c(()=>[a(ge,{modelValue:t(o).banner,"onUpdate:modelValue":s[10]||(s[10]=l=>t(o).banner=l)},{button:c(({getFile:l,previewSrc:g})=>{var _,R;return[g?(f(),U(L,{key:0,class:"q-mb-md rounded-borders",src:g},null,8,["src"])):(_=e.post)!=null&&_.banner?(f(),U(L,{key:1,class:"q-mb-md rounded-borders",src:(R=e.post)==null?void 0:R.banner},null,8,["src"])):b("",!0),a(V,{dense:"",onClick:l,"no-caps":"",flat:"",color:"primary"},{default:c(()=>{var N;return[M(p(g||(N=e.post)!=null&&N.banner?"Alterar":"Adicionar"),1)]}),_:2},1032,["onClick"])]}),_:1},8,["modelValue"])]),_:1},8,["error-message"]),a($,{label:"Tags"},{default:c(()=>[a(t(fe),{placeholder:"Adicionar tag",dense:"",outlined:"",class:"full-width","hide-bottom-space":"","input-debounce":200,onFilter:F,onFilterAbort:C,options:i.value,"option-label":"name","option-value":"id",modelValue:t(o).tags,"onUpdate:modelValue":s[11]||(s[11]=l=>t(o).tags=l),error:!!t(o).errors.tags,"error-message":t(o).errors.tags,"use-input":"","use-chips":"",multiple:"","hide-dropdown-icon":"","new-value-mode":"add-unique"},null,8,["options","modelValue","error","error-message"])]),_:1}),a($,{"error-message":t(o).errors.category_id,label:"Categoria"},{footer:c(()=>[a(V,{onClick:y,dense:"","no-caps":"",flat:"",color:"primary"},{default:c(()=>[M(" Adicionar ")]),_:1})]),default:c(()=>[a(le,{modelValue:t(o).category_id,"onUpdate:modelValue":s[12]||(s[12]=l=>t(o).category_id=l),dense:"",type:"radio",size:"sm",options:e.categories.map(l=>({label:l.name,value:l.id})),color:"primary"},{label:c(l=>[r("div",Ke,[r("span",{onClick:H(()=>m(l.value),["prevent","stop"]),class:"text-underline-hover"},p(l.label),9,Ge)])]),_:1},8,["modelValue","options"])]),_:1},8,["error-message"])])])])]),_:1},8,["onSubmit"])])]),_:1})],64))}});export{ht as default};
